"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[4678],{3050:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Nebula.Automations/Functions/send-mail","title":"Send-Mail","description":"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports.","source":"@site/docs/Nebula.Automations/Functions/send-mail.md","sourceDirName":"Nebula.Automations/Functions","slug":"/Nebula.Automations/Functions/send-mail","permalink":"/docs/Nebula.Automations/Functions/send-mail","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Send-Mail","permalink":"/docs/tags/send-mail"},{"inline":true,"label":"Nebula.Automations","permalink":"/docs/tags/nebula-automations"}],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Send-Mail","description":"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports.","hide_title":true,"id":"send-mail","tags":["Send-Mail","Nebula.Automations"]},"sidebar":"tutorialSidebar","previous":{"title":"Getting started","permalink":"/docs/Nebula.Automations/intro"},"next":{"title":"Test-MgGraphConnection","permalink":"/docs/Nebula.Automations/Functions/test-mggraphconnection"}}');var i=n(4848),l=n(8453);const r={sidebar_position:1,title:"Send-Mail",description:"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports.",hide_title:!0,id:"send-mail",tags:["Send-Mail","Nebula.Automations"]},d="Send-Mail",c={},o=[{value:"Parameters",id:"parameters",level:2},{value:"Examples",id:"examples",level:2},{value:"Tips",id:"tips",level:2}];function a(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"send-mail",children:"Send-Mail"})}),"\n",(0,i.jsx)(t.p,{children:"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports."}),"\n",(0,i.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"center"},children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"SMTPServer"})}),(0,i.jsx)(t.td,{children:"Hostname or IP of the SMTP relay to use."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"\u2014"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"SMTPPort"})}),(0,i.jsx)(t.td,{children:"TCP port of the SMTP relay."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"25"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"From"})}),(0,i.jsx)(t.td,{children:"Sender email address."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"To"})}),(0,i.jsx)(t.td,{children:"Recipient list (supports multiple values)."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Cc"})}),(0,i.jsx)(t.td,{children:"CC recipient list."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"Empty"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Bcc"})}),(0,i.jsx)(t.td,{children:"BCC recipient list."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"Empty"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Subject"})}),(0,i.jsx)(t.td,{children:"Email subject."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Body"})}),(0,i.jsx)(t.td,{children:"Email body (HTML is enabled by default)."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"AttachmentPath"})}),(0,i.jsx)(t.td,{children:"One or more file paths to attach."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"Empty"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"PlainText"})}),(0,i.jsx)(t.td,{children:"Send the body as plain text (HTML is default)."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Credential"})}),(0,i.jsx)(t.td,{children:"PSCredential used for authenticated SMTP."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"UseSsl"})}),(0,i.jsx)(t.td,{children:"Enable SSL/TLS when connecting to SMTP."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]})]})]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["The function relies on .NET ",(0,i.jsx)(t.code,{children:"System.Net.Mail.SmtpClient"}),". Auth/TLS are supported via ",(0,i.jsx)(t.code,{children:"-Credential"})," and ",(0,i.jsx)(t.code,{children:"-UseSsl"}),"; ensure your relay accepts the chosen method."]})}),"\n",(0,i.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Send a simple HTML email"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.internal.local" `\n  -From "automation@contoso.com" `\n  -To "team@contoso.com" `\n  -Subject "Job completed" `\n  -Body "<p>The overnight job finished successfully.</p>"\n'})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Add CC/BCC recipients and an attachment"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.internal.local" `\n  -SMTPPort 2525 `\n  -From "automation@contoso.com" `\n  -UseSsl `\n  -Credential (Get-Credential) `\n  -To "user1@contoso.com","user2@contoso.com" `\n  -Cc "lead@contoso.com" `\n  -Bcc "audit@contoso.com" `\n  -Subject "Weekly metrics" `\n  -Body "<p>Attached you will find the weekly metrics.</p>" `\n  -AttachmentPath "C:\\Exports\\metrics.xlsx","C:\\Exports\\trend.pdf"\n'})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Reusable helper inside a script"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'function Send-JobAlert {\n  param(\n    [string]$ReportPath,\n    [string]$Status\n  )\n\n  $subject = "Nightly job status: $Status"\n  $body = "<h2>Status: $Status</h2><p>See attached log.</p>"\n\n  Send-Mail -SMTPServer "smtp.example.com" -From "jobs@example.com" -To "ops@example.com" `\n    -Subject $subject -Body $body -AttachmentPath $ReportPath\n}\n'})}),"\n",(0,i.jsx)(t.h2,{id:"tips",children:"Tips"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Multiple attachments are supported; paths must exist or the function throws."}),"\n",(0,i.jsxs)(t.li,{children:["HTML is enabled by default. Add ",(0,i.jsx)(t.code,{children:"-PlainText"})," if your relay/policy requires plain text bodies."]}),"\n",(0,i.jsxs)(t.li,{children:["Use ",(0,i.jsx)(t.code,{children:"-UseSsl"})," and ",(0,i.jsx)(t.code,{children:"-Credential"})," when relaying through authenticated/TLS SMTP servers."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>d});var s=n(6540);const i={},l=s.createContext(i);function r(e){const t=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);