"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[2748],{3057:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"Nebula/Log/usage/write-log","title":"Write-Log","description":"Main entry point for writing console and file logs with levels, rotation, JSON, and optional colors.","source":"@site/docs/Nebula/Log/usage/write-log.md","sourceDirName":"Nebula/Log/usage","slug":"/Nebula/Log/usage/write-log","permalink":"/docs/Nebula/Log/usage/write-log","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Log","permalink":"/docs/tags/log"},{"inline":true,"label":"Nebula.Log","permalink":"/docs/tags/nebula-log"}],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Write-Log","description":"Main entry point for writing console and file logs with levels, rotation, JSON, and optional colors.","hide_title":true,"id":"write-log","tags":["Log","Nebula.Log"]},"sidebar":"tutorialSidebar","previous":{"title":"Getting started","permalink":"/docs/Nebula/Log/intro"},"next":{"title":"Test-ActivityLog","permalink":"/docs/Nebula/Log/usage/test-activitylog"}}');var t=s(4848),l=s(8453);const o={sidebar_position:1,title:"Write-Log",description:"Main entry point for writing console and file logs with levels, rotation, JSON, and optional colors.",hide_title:!0,id:"write-log",tags:["Log","Nebula.Log"]},r="Write-Log",d={},c=[{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Behavior",id:"behavior",level:2},{value:"Where logs go by default",id:"where-logs-go-by-default",level:2},{value:"Rotation defaults",id:"rotation-defaults",level:2},{value:"Examples",id:"examples",level:2},{value:"Questions and answers",id:"questions-and-answers",level:2},{value:"What is the default log directory?",id:"what-is-the-default-log-directory",level:3},{value:"How are rotated files named?",id:"how-are-rotated-files-named",level:3},{value:"Does console logging stop when I set <code>-WriteToFile</code>?",id:"does-console-logging-stop-when-i-set--writetofile",level:3},{value:"What does <code>-AsJson</code> look like?",id:"what-does--asjson-look-like",level:3},{value:"Can I capture the log entry as an object?",id:"can-i-capture-the-log-entry-as-an-object",level:3},{value:"How do I add colors?",id:"how-do-i-add-colors",level:3}];function a(e){const i={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"write-log",children:"Write-Log"})}),"\n",(0,t.jsx)(i.p,{children:"Main entry point for writing console and file logs with levels, rotation, JSON, and optional colors."}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsxs)(i.p,{children:["The function name is ",(0,t.jsx)(i.code,{children:"Write-Log"}),". The legacy alias ",(0,t.jsx)(i.code,{children:"Log-Message"})," remains available for backward compatibility."]})}),"\n",(0,t.jsx)(i.h2,{id:"syntax",children:"Syntax"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-powershell",children:"Write-Log [-LogLocation <String>] -Message <String> [-LogFileName <String>] [-Level <String>]\n          [-WriteToFile] [-WriteOnlyToFile] [-MaxFileSizeKB <Int>] [-AsJson] [-PassThru] [-Color]\n"})}),"\n",(0,t.jsx)(i.h2,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Name"}),(0,t.jsx)(i.th,{children:"Type"}),(0,t.jsx)(i.th,{children:"Default"}),(0,t.jsx)(i.th,{children:"Description"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"LogLocation"})}),(0,t.jsx)(i.td,{children:"string"}),(0,t.jsx)(i.td,{children:"inferred"}),(0,t.jsx)(i.td,{children:"Optional directory for logs. If omitted, uses the first caller script folder outside the module, otherwise the current directory."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"Message"})}),(0,t.jsx)(i.td,{children:"string"}),(0,t.jsx)(i.td,{children:"n/a"}),(0,t.jsx)(i.td,{children:"Message to log."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"LogFileName"})}),(0,t.jsx)(i.td,{children:"string"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"activity.log"})}),(0,t.jsx)(i.td,{children:"File name. Invalid file-name characters are rejected."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"Level"})}),(0,t.jsx)(i.td,{children:"INFO, SUCCESS, WARNING, DEBUG, ERROR"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"INFO"})}),(0,t.jsx)(i.td,{children:"Log level and console color mapping."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"WriteToFile"})}),(0,t.jsx)(i.td,{children:"switch"}),(0,t.jsx)(i.td,{children:"off"}),(0,t.jsx)(i.td,{children:"Write the entry to file. Creates the directory if missing."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"WriteOnlyToFile"})}),(0,t.jsx)(i.td,{children:"switch"}),(0,t.jsx)(i.td,{children:"off"}),(0,t.jsx)(i.td,{children:"Suppress console output. Only relevant when logging to file."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"MaxFileSizeKB"})}),(0,t.jsx)(i.td,{children:"int"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"512"})}),(0,t.jsx)(i.td,{children:"Threshold before rotation. Minimum enforced value is 1 KB."})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"AsJson"})}),(0,t.jsx)(i.td,{children:"switch"}),(0,t.jsx)(i.td,{children:"off"}),(0,t.jsxs)(i.td,{children:["Emit JSON Lines objects (",(0,t.jsx)(i.code,{children:'{"timestamp":"...","level":"...","message":"..."}'}),")."]})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"PassThru"})}),(0,t.jsx)(i.td,{children:"switch"}),(0,t.jsx)(i.td,{children:"off"}),(0,t.jsxs)(i.td,{children:["Return a ",(0,t.jsx)(i.code,{children:"[pscustomobject]"})," with Timestamp, Level, Message, Path (if written)."]})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"Color"})}),(0,t.jsx)(i.td,{children:"switch"}),(0,t.jsx)(i.td,{children:"off"}),(0,t.jsx)(i.td,{children:"Colorize console output by level."})]})]})]}),"\n",(0,t.jsx)(i.h2,{id:"behavior",children:"Behavior"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Directory resolution: ",(0,t.jsx)(i.code,{children:"Resolve-LogLocation"})," finds the target folder and can create it."]}),"\n",(0,t.jsxs)(i.li,{children:["Rotation: when ",(0,t.jsx)(i.code,{children:"-WriteToFile"})," is set and the file size is at least ",(0,t.jsx)(i.code,{children:"MaxFileSizeKB"}),", the existing file is moved to ",(0,t.jsx)(i.code,{children:"<name>.<yyyyMMdd-HHmmss>.bak"})," and a new file starts."]}),"\n",(0,t.jsx)(i.li,{children:"Encoding: file writes use UTF-8 (no BOM) with small retries to handle transient locks."}),"\n",(0,t.jsxs)(i.li,{children:["Console formatting: plain text by default; JSON when ",(0,t.jsx)(i.code,{children:"-AsJson"}),"; optional colors when ",(0,t.jsx)(i.code,{children:"-Color"}),"."]}),"\n",(0,t.jsxs)(i.li,{children:["Error handling: failed file writes raise an error; rotation issues are reported with ",(0,t.jsx)(i.code,{children:"Write-Error"})," but do not stop execution unless the write itself fails."]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"where-logs-go-by-default",children:"Where logs go by default"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"LogLocation"})," is optional. If you do not set it:"]}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Nebula.Log inspects the call stack and uses the folder of the first caller script outside the module."}),"\n",(0,t.jsx)(i.li,{children:"If nothing is found (for example, an interactive console), it falls back to the current working directory."}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"rotation-defaults",children:"Rotation defaults"}),"\n",(0,t.jsxs)(i.p,{children:["If ",(0,t.jsx)(i.code,{children:"-WriteToFile"})," is used and the log file reaches 512 KB, it is archived as ",(0,t.jsx)(i.code,{children:"<name>.<yyyyMMdd-HHmmss>.bak"})," and a fresh file is created."]}),"\n",(0,t.jsx)(i.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(i.p,{children:"Minimal console log:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-powershell",children:'Write-Log -Message "Ready" -Level INFO\n'})}),"\n",(0,t.jsx)(i.p,{children:"Write and rotate at 128 KB:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-powershell",children:'Write-Log -LogLocation "C:\\Logs\\Sales" `\n          -LogFileName "sales.log" `\n          -Message "Batch completed" `\n          -Level SUCCESS `\n          -WriteToFile `\n          -MaxFileSizeKB 128\n'})}),"\n",(0,t.jsx)(i.p,{children:"Quiet file-only JSON logging, returning the object:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-powershell",children:'$entry = Write-Log -Message "Webhook accepted" -Level DEBUG `\n                   -AsJson -WriteToFile -WriteOnlyToFile -PassThru\n'})}),"\n",(0,t.jsx)(i.p,{children:"Colorized console output without touching the disk:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-powershell",children:'Write-Log -Message "Heads up" -Level WARNING -Color\n'})}),"\n",(0,t.jsx)(i.h2,{id:"questions-and-answers",children:"Questions and answers"}),"\n",(0,t.jsx)(i.h3,{id:"what-is-the-default-log-directory",children:"What is the default log directory?"}),"\n",(0,t.jsxs)(i.p,{children:["If ",(0,t.jsx)(i.code,{children:"LogLocation"})," is not provided, Nebula.Log inspects the call stack and uses the first caller script folder outside the module. When it cannot find a caller script (for example, in the interactive console), it falls back to the current working directory."]}),"\n",(0,t.jsx)(i.h3,{id:"how-are-rotated-files-named",children:"How are rotated files named?"}),"\n",(0,t.jsxs)(i.p,{children:["When the size reaches ",(0,t.jsx)(i.code,{children:"MaxFileSizeKB"}),", the current file is moved to ",(0,t.jsx)(i.code,{children:"<name>.<yyyyMMdd-HHmmss>.bak"})," in the same directory, and a new file starts."]}),"\n",(0,t.jsxs)(i.h3,{id:"does-console-logging-stop-when-i-set--writetofile",children:["Does console logging stop when I set ",(0,t.jsx)(i.code,{children:"-WriteToFile"}),"?"]}),"\n",(0,t.jsxs)(i.p,{children:["No. ",(0,t.jsx)(i.code,{children:"-WriteToFile"})," adds file output and keeps console output. Use ",(0,t.jsx)(i.code,{children:"-WriteOnlyToFile"})," to suppress console output."]}),"\n",(0,t.jsxs)(i.h3,{id:"what-does--asjson-look-like",children:["What does ",(0,t.jsx)(i.code,{children:"-AsJson"})," look like?"]}),"\n",(0,t.jsx)(i.p,{children:"Output is one JSON object per line, for example:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-json",children:'{"timestamp":"2025-12-03T10:55:00.0000000Z","level":"INFO","message":"Service ready"}\n'})}),"\n",(0,t.jsx)(i.h3,{id:"can-i-capture-the-log-entry-as-an-object",children:"Can I capture the log entry as an object?"}),"\n",(0,t.jsxs)(i.p,{children:["Yes. Add ",(0,t.jsx)(i.code,{children:"-PassThru"})," to receive a ",(0,t.jsx)(i.code,{children:"[pscustomobject]"})," containing ",(0,t.jsx)(i.code,{children:"Timestamp"}),", ",(0,t.jsx)(i.code,{children:"Level"}),", ",(0,t.jsx)(i.code,{children:"Message"}),", and ",(0,t.jsx)(i.code,{children:"Path"})," (when writing to file)."]}),"\n",(0,t.jsx)(i.h3,{id:"how-do-i-add-colors",children:"How do I add colors?"}),"\n",(0,t.jsxs)(i.p,{children:["Use ",(0,t.jsx)(i.code,{children:"-Color"})," on ",(0,t.jsx)(i.code,{children:"Write-Log"}),". Colors by level: SUCCESS = Green, WARNING = Yellow, DEBUG = Cyan, ERROR = Red, INFO = White."]})]})}function h(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,i,s)=>{s.d(i,{R:()=>o,x:()=>r});var n=s(6540);const t={},l=n.createContext(t);function o(e){const i=n.useContext(l);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(l.Provider,{value:i},e.children)}}}]);