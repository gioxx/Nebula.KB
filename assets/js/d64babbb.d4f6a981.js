"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[8246],{4035:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>r});const o=JSON.parse('{"id":"Nebula/Automations/usage/more-examples","title":"More examples","description":"Practical recipes that show common ways to use Nebula.Automations.","source":"@site/docs/Nebula/Automations/usage/more-examples.md","sourceDirName":"Nebula/Automations/usage","slug":"/Nebula/Automations/usage/more-examples","permalink":"/docs/Nebula/Automations/usage/more-examples","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Nebula.Automations","permalink":"/docs/tags/nebula-automations"},{"inline":true,"label":"Examples","permalink":"/docs/tags/examples"},{"inline":true,"label":"Automations","permalink":"/docs/tags/automations"}],"version":"current","sidebarPosition":50,"frontMatter":{"sidebar_position":50,"title":"More examples","description":"Practical recipes that show common ways to use Nebula.Automations.","hide_title":true,"id":"more-examples","tags":["Nebula.Automations","Examples","Automations"]},"sidebar":"tutorialSidebar","previous":{"title":"Test-MgGraphConnection","permalink":"/docs/Nebula/Automations/usage/test-mggraphconnection"},"next":{"title":"Getting started","permalink":"/docs/Nebula/Core/intro"}}');var a=n(4848),i=n(8453);const s={sidebar_position:50,title:"More examples",description:"Practical recipes that show common ways to use Nebula.Automations.",hide_title:!0,id:"more-examples",tags:["Nebula.Automations","Examples","Automations"]},l="More examples",c={},r=[{value:"Send a styled HTML e-mail",id:"send-a-styled-html-e-mail",level:2},{value:"Authenticated SMTP with TLS and attachments",id:"authenticated-smtp-with-tls-and-attachments",level:2},{value:"Plain-text notification to multiple recipients (To + CC + BCC)",id:"plain-text-notification-to-multiple-recipients-to--cc--bcc",level:2},{value:"Validate Microsoft Graph app connectivity",id:"validate-microsoft-graph-app-connectivity",level:2},{value:"Auto-install Microsoft.Graph if missing",id:"auto-install-microsoftgraph-if-missing",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"more-examples",children:"More examples"})}),"\n",(0,a.jsx)(t.p,{children:"Practical recipes that show common ways to use Nebula.Automations."}),"\n",(0,a.jsx)(t.h2,{id:"send-a-styled-html-e-mail",children:"Send a styled HTML e-mail"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-powershell",children:'$body = @"\n<h2 style="color:#0a6ebd;">Report ready</h2>\n<p>The nightly batch finished successfully.</p>\n"@\n\nSend-Mail `\n  -SMTPServer "smtp.internal.local" `\n  -From "automation@contoso.com" `\n  -To "team@contoso.com" `\n  -Subject "Nightly batch OK" `\n  -Body $body\n'})}),"\n",(0,a.jsx)(t.h2,{id:"authenticated-smtp-with-tls-and-attachments",children:"Authenticated SMTP with TLS and attachments"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-powershell",children:'$cred = Get-Credential  # relay credentials\n\nSend-Mail `\n  -SMTPServer "smtp.secure.local" `\n  -SMTPPort 587 `\n  -UseSsl `\n  -Credential $cred `\n  -From "alerts@contoso.com" `\n  -To "ops@contoso.com" `\n  -Subject "Alert with attachment" `\n  -Body "<p>See attached log.</p>" `\n  -AttachmentPath "C:\\Logs\\alert.log"\n'})}),"\n",(0,a.jsx)(t.h2,{id:"plain-text-notification-to-multiple-recipients-to--cc--bcc",children:"Plain-text notification to multiple recipients (To + CC + BCC)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.internal.local" `\n  -From "notifications@contoso.com" `\n  -To "primary@contoso.com","secondary@contoso.com" `\n  -Cc "manager@contoso.com" `\n  -Bcc "audit@contoso.com" `\n  -Subject "Maintenance window" `\n  -Body "Service downtime tonight 22:00-23:00 UTC." `\n  -PlainText\n'})}),"\n",(0,a.jsx)(t.h2,{id:"validate-microsoft-graph-app-connectivity",children:"Validate Microsoft Graph app connectivity"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-powershell",children:'$connected = Test-MgGraphConnection `\n  -TenantId "00000000-0000-0000-0000-000000000000" `\n  -ClientId "11111111-1111-1111-1111-111111111111" `\n  -ClientSecret (Get-Content "$env:APPDATA\\\\nebula\\\\.graph_secret.txt" -Raw) `\n  -LogLocation "$env:APPDATA\\\\nebula\\\\logs\\\\graph-connect.log"\n\nif (-not $connected) { throw "Unable to connect to Microsoft Graph." }\n'})}),"\n",(0,a.jsx)(t.h2,{id:"auto-install-microsoftgraph-if-missing",children:"Auto-install Microsoft.Graph if missing"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-powershell",children:'if (-not (Test-MgGraphConnection -TenantId $tenantId -ClientId $clientId -ClientSecret $clientSecret -AutoInstall)) {\n    throw "Graph connection failed even after installing Microsoft.Graph."\n}\n'})})]})}function m(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var o=n(6540);const a={},i=o.createContext(a);function s(e){const t=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:t},e.children)}}}]);